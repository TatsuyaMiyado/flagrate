(function(){if("undefined"!==typeof window.flagrate)throw Error("[conflict] flagrate is already defined.");var f=window.flagrate={};f.className="flagrate";var A=f.identity=function(a){return a};f.objectCloner=function(a){return JSON.parse(JSON.stringify(a))};var m=f.extendObject=function(a,b){for(var c in b)a[c]=b[c];return a},e=f.Element=function(a,b){b=b||null;a=(a||"div").toLowerCase();var c;e.cache[a]?c=e.cache[a].cloneNode(!1):null!==b&&"type"in b||"select"===a?c=document.createElement(a):(c=
document.createElement(a),e.cache[a]=c.cloneNode(!1));m(c,this);return null===b?c:e.writeAttribute(c,b)};e.cache={};e.prototype={visible:function(){return e.visible(this)},toggle:function(){return e.toggle(this)},hide:function(){return e.hide(this)},show:function(){return e.show(this)},remove:function(){return e.remove(this)},update:function(a){return e.update(this,a)},updateText:function(a){return e.updateText(this,a)},insert:function(a){return e.insert(this,a)},insertText:function(a){return e.insertText(this,
a)},insertTo:function(a){return e.insertTo(this,a)},readAttribute:function(a){return e.readAttribute(this,a)},writeAttribute:function(a,b){return e.writeAttribute(this,a,b)},getDimensions:function(){return e.getDimensions(this)},getHeight:function(){return e.getHeight(this)},getWidth:function(){return e.getWidth(this)},cumulativeOffset:function(){return e.cumulativeOffset(this)},cumulativeScrollOffset:function(){return e.cumulativeScrollOffset(this)},hasClassName:function(a){return e.hasClassName(this,
a)},addClassName:function(a){return e.addClassName(this,a)},removeClassName:function(a){return e.removeClassName(this,a)},toggleClassName:function(a){return e.toggleClassName(this,a)},getStyle:function(a){return e.getStyle(this,a)},setStyle:function(a){return e.setStyle(this,a)}};e.visible=function(a){return"none"!==a.style.display};e.toggle=function(a){return e[e.visible(a)?"hide":"show"](a)};e.hide=function(a){a.style.display="none";return a};e.show=function(a){a.style.display="";return a};e.remove=
function(a){a.parentNode&&a.parentNode.removeChild(a);return a};e.update=function(a,b){if(!b)return a.innerHTML="",a;if(b instanceof HTMLElement)return a.innerHTML="",a.appendChild(b),a;"string"!==typeof b&&(b=b.toString(10));a.innerHTML=b;return a};e.updateText=function(a,b){if(!b)return a.innerHTML="",a;if(b instanceof HTMLElement&&"undefined"!==typeof b.toString)return e.updateText(a,b.toString());"string"!==typeof b&&(b=b.toString(10));a.innerHTML="";a.appendChild(document.createTextNode(b));
return a};e.insert=function(a,b){if("string"===typeof b||"number"===typeof b||b instanceof HTMLElement)b={bottom:b};var c,d,k;for(k in b)if(c=b[k],k=k.toLowerCase(),d=e._insertionTranslation[k],c instanceof HTMLElement)d(a,c);else{"string"!==typeof c&&(c=c.toString(10));var f=new e;f.innerHTML=c;"top"!==k&&"after"!==k||(void 0).reverse();for(c=0;c<f.childNodes.length;c++)d(a,f.childNodes[c])}return a};e.insertText=function(a,b){if("string"===typeof b||"number"===typeof b)b={bottom:b};var c,d,k;for(k in b)c=
b[k],k=k.toLowerCase(),d=e._insertionTranslation[k],"string"!==typeof c&&(c=c.toString(10)),d(a,document.createTextNode(c));return a};e.insertTo=function(a,b){e.insert(b,a);return a};e.wrap=function(a,b,c){b instanceof HTMLElement?c&&e.writeAttribute(b,c):b="string"===typeof b?new e(b,c):new e("div",b);a.parentNode&&a.parentNode.replaceChild(b,a);b.appendChild(a);return b};e.readAttribute=function(a,b){return a.getAttribute(b)};e.writeAttribute=function(a,b,c){var d={};"object"===typeof b?d=b:d[b]=
"undefined"===typeof c?!0:c;for(var e in d)c=d[e],!1===c||null===c?a.removeAttribute(e):!0===c?a.setAttribute(e,e):"undefined"!==typeof c&&a.setAttribute(e,c);return a};e.getDimensions=function(a){var b=e.getStyle(a,"display");if(b&&"none"!==b)return{width:a.offsetWidth,height:a.offsetHeight};var b={visibility:a.style.visibility,position:a.style.position,display:a.style.display},c={visibility:"hidden",display:"block"};"fixed"!==b.position&&(c.position="absolute");e.setStyle(a,c);c={width:a.offsetWidth,
height:a.offsetHeight};e.setStyle(a,b);return c};e.getHeight=function(a){return e.getDimensions(a).height};e.getWidth=function(a){return e.getDimensions(a).width};e.cumulativeOffset=function(a){var b=0,c=0;if(a.parentNode){do b+=a.offsetTop||0,c+=a.offsetLeft||0,a=a.offsetParent;while(a)}return{top:b,left:c}};e.cumulativeScrollOffset=function(a){var b=0,c=0;do b+=a.scrollTop||0,c+=a.scrollLeft||0,a=a.parentNode;while(a);return{top:b,left:c}};e.hasClassName=function(a,b){return 0<a.className.length&&
(a.className===b||RegExp("(^|\\s)"+b+"(\\s|$)").test(a.className))};e.addClassName=function(a,b){e.hasClassName(a,b)||(a.className+=(a.className?" ":"")+b);return a};e.removeClassName=function(a,b){a.className=a.className.replace(RegExp("(^|\\s+)"+b+"(\\s+|$)")," ").trim();return a};e.toggleClassName=function(a,b){return e[e.hasClassName(a,b)?"removeClassName":"addClassName"](a,b)};e.getStyle=function(a,b){"float"===b&&(b="cssFloat");var c=a.style[b];c&&"auto"!==c||(c=(c=document.defaultView.getComputedStyle(a,
null))?c.getPropertyValue(b):null);return"opacity"===b?c?parseFloat(c):1:"auto"===c?null:c};e.setStyle=function(a,b){for(var c in b)a.style["float"===c||"cssFloat"===c?"undefined"===typeof a.style.styleFloat?"cssFloat":"styleFloat":c]=b[c];return a};e._insertionTranslation={before:function(a,b){a.parentNode.insertBefore(b,a)},top:function(a,b){a.insertBefore(b,a.firstChild)},bottom:function(a,b){a.appendChild(b)},after:function(a,b){a.parentNode.insertBefore(b,a.nextSibling)}};var p=f.Button=function(a){a=
a||{};a.label=a.label||"";a.isRemovableByUser=a.isRemovableByUser||!1;this.onSelect=a.onSelect||function(){};this.onRemove=a.onRemove||function(){};var b=a.attribute||{};b.id=a.id||null;b["class"]=a.className||null;b.autofocus=a.isFocused||!1;b=(new e("button",b)).updateText(a.label);m(b,this);b.addClassName(f.className+" "+f.className+"-button");b.addEventListener("click",b._onSelectHandler.bind(b));a.icon&&(b.addClassName(f.className+"-icon"),b.setStyle({backgroundImage:"url("+a.icon+")"}));a.isRemovableByUser&&
(b._removeButton=(new e("button",{"class":f.className+"-button-remove"})).insertTo(b),b._removeButton.addEventListener("click",b._onRemoveHandler.bind(b)));a.style&&b.setStyle(a.style);a.color&&b.setColor(a.color);a.isDisabled&&b.disable();return b};p.prototype={select:function(){return this._onSelectHandler(null)},disable:function(){this.addClassName(f.className+"-button-disabled");this.writeAttribute("disabled",!0);return this},enable:function(){this.removeClassName(f.className+"-button-disabled");
this.writeAttribute("disabled",!1);return this},isEnabled:function(){return!this.hasClassName(f.className+"-button-disabled")},setColor:function(a){"@"===a.charAt(0)?(this.style.backgroundColor="",this.addClassName(f.className+"-button-color-"+a.slice(1))):this.style.backgroundColor=a;return this},_onSelectHandler:function(a){if(!1!==this.isEnabled()){if(this.isRemovableByUser&&a&&a.layerX){var b=this.getWidth(),c=this.getHeight(),d=parseInt(this.getStyle("padding-right").replace("px",""),10),e=this._removeButton.getWidth(),
f=this._removeButton.getHeight(),h=a.layerX,n=a.layerY;if(h>b-d-e&&h<b-d&&n>c-(c-f)/2-f&&n<c-(c-f)/2)return this._onRemoveHandler(a),this}this.onSelect(a)}},_onRemoveHandler:function(a){if(this.isEnabled()&&this.remove())this.onRemove(a)}};var t=f.Menu=function(a){a=a||{};a.items=a.items||[];this.onSelect=a.onSelect||function(){};var b=a.attribute||{};b.id=a.id;b["class"]=a.className;b=new e("div",b);m(b,this);b.addClassName(f.className+" "+f.className+"-menu");for(var c=0,d=a.items.length;c<d;c++)b.push(a.items[c]);
b.addEventListener("click",function(a){a.stopPropagation();a.preventDefault()});return b};t.prototype={push:function(a){if(!(a instanceof Array))if("string"===typeof a)(new e("hr")).insertTo(this);else{var b=(new p({icon:a.icon,label:a.label,isDisabled:a.isDisabled,onSelect:function(b){if(a.onSelect)a.onSelect(b);this.onSelect(b)}.bind(this)})).insertTo(this);a.key&&(b._key=a.key)}return this},getButtonByKey:function(a){for(var b=null,c=this.childNodes,d=0;d<c.length;d++)if(c[d]._key&&c[d]._key===
a){b=element[d]._key;break}return b}};f.Pulldown=function(a){a=a||{};a.label=a.label||"";a.items=a.items||null;a.onSelect=a.onSelect||function(){};var b=new p({attribute:a.attribute,label:a.label,icon:a.icon});m(b,this);b.addClassName(f.className+"-pulldown");b.onSelect=function(c){if(b._menu)b._menu.remove(),delete b._menu;else{var d=function(a){document.body.removeEventListener("click",d);b.parentNode.removeEventListener("click",d);b.removeEventListener("click",d);e.style.opacity="0";setTimeout(function(){e.remove()}.bind(this),
500);delete b._menu},e=b._menu=new t({className:f.className+"-pulldown-menu",items:a.items,onSelect:function(){a.onSelect();e.remove();delete b._menu}});e.style.top=b.offsetTop+b.getHeight()+"px";e.style.left=b.offsetLeft+"px";b.insert({after:e});setTimeout(function(){document.body.addEventListener("click",d);b.parentNode.addEventListener("click",d);b.addEventListener("click",d)},0)}};(new e("span",{"class":f.className+"-pulldown-triangle"})).insertTo(b);a.style&&b.setStyle(a.style);a.color&&b.setColor(a.color);
a.isDisabled&&b.disable();return b};(f.Popover=function(a){a=a||{};this.target=a.target||null;var b=a.text||null,c=a.html||null,d=a.element||null;this.isShowing=!1;this.open=function(a){var g=window.event||{},h=this.target||g.target||document.body;a instanceof HTMLElement&&(h=a);this.isShowing&&this.close();this.isShowing=!0;this._div=new e("div",{"class":f.className+" "+f.className+"-popover"});b&&this._div.updateText(b);c&&this._div.update(c);d&&this._div.update(d);this._div.style.opacity=0;this._div.insertTo(document.body);
var n=e.cumulativeOffset(h),q=e.cumulativeScrollOffset(h),l=e.getWidth(h),h=e.getHeight(h),m=this._div.getWidth();a=this._div.getHeight();l=n.left-q.left+l/2-m/2;n=n.top-q.top+h;q="top";n+a>window.innerHeight&&(q="bottom",n=window.innerHeight-n+h);this._div.addClassName(f.className+"-popover-tail-"+q);this._div.style.left=l+"px";this._div.style[q]=n+"px";this._div.style.opacity=1;g.type&&"mouseover"===g.type&&(document.body.addEventListener("click",this.close),document.body.addEventListener("mouseout",
this.close));document.body.addEventListener("mouseup",this.close);document.body.addEventListener("mousewheel",this.close);g=function(a){a.stopPropagation();"mousewheel"===a.type&&a.preventDefault()};this._div.addEventListener("click",g);this._div.addEventListener("mouseup",g);this._div.addEventListener("mousewheel",g);return this}.bind(this);this.close=function(){document.body.removeEventListener("click",this.close);document.body.removeEventListener("mouseup",this.close);document.body.removeEventListener("mouseout",
this.close);document.body.removeEventListener("mousewheel",this.close);this.isShowing=!1;var a=this._div;setTimeout(function(){a&&a.remove&&a.remove()},0);delete this._div;return this}.bind(this);null!==this.target&&this.target.addEventListener("mouseover",this.open);return this}).prototype={visible:function(){return this.isShowing},remove:function(){this._div&&this.close();null!==this.target&&this.target.removeEventListener("mouseover",this.open)}};var w=f.ContextMenu=function(a){a=a||{};this.target=
a.target||null;this.items=a.items||null;this.isShowing=!1;this.open=function(a){a=a||window.event||{};a.preventDefault&&a.preventDefault();this.isShowing&&this.close();this.isShowing=!0;this._menu=new t({className:f.className+"-context-menu",items:this.items,onSelect:this.close.bind(this)});var c=a.clientX||0;a=a.clientY||0;this._menu.style.opacity=0;this._menu.insertTo(document.body);c+this._menu.getWidth()>window.innerWidth&&(c-=this._menu.getWidth());a+this._menu.getHeight()>window.innerHeight&&
(a-=this._menu.getHeight());this._menu.style.top=a+"px";this._menu.style.left=c+"px";this._menu.style.opacity=1;document.body.addEventListener("click",this.close);document.body.addEventListener("mouseup",this.close);document.body.addEventListener("mousewheel",this.close);return this}.bind(this);this.close=function(){document.body.removeEventListener("click",this.close);document.body.removeEventListener("mouseup",this.close);document.body.removeEventListener("mousewheel",this.close);this.isShowing=
!1;var a=this._menu;setTimeout(function(){a&&a.remove&&a.remove()},0);delete this._menu;return this}.bind(this);null!==this.target&&this.target.addEventListener("contextmenu",this.open);return this};w.prototype={visible:function(){return this.isShowing},remove:function(){this._menu&&this.close();null!==this.target&&this.target.removeEventListener("contextmenu",this.open)}};var x=f.Toolbar=function(a){a=a||{};a.items=a.items||[];var b=a.attribute||{};b.id=a.id;b["class"]=a.className;b=new e("div",
b);m(b,this);b.addClassName(f.className+" "+f.className+"-toolbar");for(var c=0,d=a.items.length;c<d;c++)b.push(a.items[c]);a.style&&b.setStyle(a.style);return b};x.prototype={push:function(a){"string"===typeof a?(new e("hr")).insertTo(this):a instanceof HTMLElement?this.insert(a):a.element&&(a.key&&(a.element._key=a.key),this.insert(a.element));return this},getElementByKey:function(a){for(var b=null,c=this.childNodes,d=0;d<c.length;d++)if(c[d]._key&&c[d]._key===a){b=c[d];break}return b}};var y=f.TextInput=
function(a){a=a||{};this.regexp=a.regexp||null;var b=a.attribute||{};b.id=a.id||null;b["class"]=a.className||null;b.value=a.value||null;b.placeholder=a.placeholder||null;b=new e("input",b);m(b,this);b.addClassName(f.className+" "+f.className+"-textinput");a.icon&&(b.addClassName(f.className+"-icon"),b.setStyle({backgroundImage:"url("+a.icon+")"}));a.style&&b.setStyle(a.style);a.isDisabled&&b.disable();return b};y.prototype={disable:function(){this.addClassName(f.className+"-textinput-disabled");this.writeAttribute("disabled",
!0);return this},enable:function(){this.removeClassName(f.className+"-textinput-disabled");this.writeAttribute("disabled",!1);return this},isEnabled:function(){return!this.hasClassName(f.className+"-textinput-disabled")},getValue:function(){return this.readAttribute("value")||""},setValue:function(a){return this.writeAttribute("value",a)},isValid:function(){return this.regexp.test(this.getValue())}};(f.Tokenizer=function(a){a=a||{};a.placeholder=a.placeholder||null;this.values=a.values||[];this.max=
a.max||-1;this.tokenize=a.tokenize||A;this.onChange=a.onChange||function(){};var b=a.attribute||{};b.id=a.id||null;b["class"]=a.className||null;b=new e("div",b);m(b,this);b.addClassName(f.className+" "+f.className+"-tokenizer");a.icon&&(b.addClassName(f.className+"-icon"),b.setStyle({backgroundImage:"url("+a.icon+")"}));b._tokens=(new e("span")).insertTo(b);b._input=(new y({placeholder:a.placeholder})).insertTo(b);0!==b.values.length&&b._updateTokens();b.addEventListener("click",b._onClickHandler.bind(b));
b._input.addEventListener("keydown",b._onKeydownHandler.bind(b));b._input.addEventListener("focus",b._onFocusHandler.bind(b));b._input.addEventListener("blur",b._onBlurHandler.bind(b));a.style&&b.setStyle(a.style);a.isDisabled&&b.disable();return b}).prototype={disable:function(){this.addClassName(f.className+"-tokenizer-disabled");this._input.disable();return this._updateTokens()},enable:function(){this.removeClassName(f.className+"-tokenizer-disabled");this._input.enable();return this._updateTokens()},
isEnabled:function(){return!this.hasClassName(f.className+"-tokenizer-disabled")},getValues:function(){return this.values},setValues:function(a){this.values=a;return this._updateTokens()},removeAllValues:function(){this.values=[];return this._updateTokens()},removeValue:function(a){this.values.splice(this.values.indexOf(a),1);return this._updateTokens()},_updateTokens:function(){this._tokens.update();for(var a=0,b=this.values.length;a<b;a++){var c=this.values[a],d="",d="string"===typeof c?c:c.label;
(new p({isDisabled:!1===this.isEnabled(),isRemovableByUser:this.isEnabled(),onRemove:this._createTokenButtonOnRemoveHandler(this,c),label:d})).insertTo(this._tokens)}var a=this.getWidth(),b=parseInt(this.getStyle("border-width").replace("px",""),10)||2,c=parseInt(this.getStyle("padding-left").replace("px",""),10)||4,d=parseInt(this.getStyle("padding-right").replace("px",""),10)||4,e=this._tokens.getWidth(),f=parseInt(this._tokens.getStyle("margin-left").replace("px",""),10)||2,h=parseInt(this._input.getStyle("margin-left").replace("px",
""),10)||2,n=parseInt(this._input.getStyle("padding-left").replace("px",""),10)||2,a=a-c-d-e-f-h-n-2*b;this._input.style.width=30<a?a+"px":-5>a?"":"100%";return this},_createTokenButtonOnRemoveHandler:function(a,b){return function(){a.removeValue(b)}},_tokenize:function(a){this._candidates=[];(a=this.tokenize(this._input.value,this._tokenized.bind(this)))&&this._tokenized(a);this._lastTokenizedValue=this._input.value;return this},_tokenized:function(a){!1===a instanceof Array&&(a=[a]);this._candidates=
a;var b=new t({onSelect:function(){b.remove()}});b.style.left=this._input.offsetLeft+"px";this.insert({top:b});for(var c=0,d=a.length;c<d;c++){var e=a[c],f;f="string"===typeof e?{label:e}:e;f.onSelect&&(f._onSelect=f.onSelect);f.onSelect=this._createMenuOnSelectHandler(this,e,f);b.push(f)}this._menu&&this._menu.remove();this._menu=b;return this},_createMenuOnSelectHandler:function(a,b,c){return function(d){(0>a.max||a.max>a.values.length)&&a.values.push(b);a._updateTokens();a.onChange();c._onSelect&&
c._onSelect(d)}},_onClickHandler:function(a){this._input.focus()},_onKeydownHandler:function(a){13===a.keyCode&&this._lastTokenizedValue!==this._input.value?(a.stopPropagation(),a.preventDefault(),this._lastTokenizedValue=this._input.value,this._tokenize()):(!this._candidates||0===this._candidates.length||13!==a.keyCode&&39!==a.keyCode||(a.stopPropagation(),a.preventDefault(),this._input.value="",(0>this.max||this.max>this.values.length)&&this.values.push(this._candidates[0]),this._updateTokens(),
this.onChange(),this._menu&&this._menu.remove()),""===this._input.value&&0!==this.values.length&&8===a.keyCode&&(a.stopPropagation(),a.preventDefault(),this._input.value=this.values.pop(),this._updateTokens(),this.onChange(),this._menu&&this._menu.remove()),setTimeout(function(){-1<this.max&&this.max<=this.values.length&&""!==this._input.value?(a.stopPropagation(),this._input.value=""):this._tokenize()}.bind(this),0))},_onFocusHandler:function(a){this._updateTokens();this._tokenize()},_onBlurHandler:function(a){this._input.value=
"";this._menu&&(this._menu.style.opacity="0",setTimeout(function(){this._menu.remove()}.bind(this),500))}};(f.TextArea=function(a){a=a||{};this.regexp=a.regexp||null;var b=a.attribute||{};b.id=a.id||null;b["class"]=a.className||null;b.placeholder=a.placeholder||null;b=new e("textarea",b);m(b,this);b.addClassName(f.className+" "+f.className+"-textarea");a.icon&&(b.addClassName(f.className+"-icon"),b.setStyle({backgroundImage:"url("+a.icon+")"}));a.value&&b.setValue(a.value);a.style&&b.setStyle(a.style);
a.isDisabled&&b.disable();return b}).prototype={disable:function(){this.addClassName(f.className+"-textarea-disabled");this.writeAttribute("disabled",!0);return this},enable:function(){this.removeClassName(f.className+"-textarea-disabled");this.writeAttribute("disabled",!1);return this},isEnabled:function(){return!this.hasClassName(f.className+"-textarea-disabled")},getValue:function(){return this.value||""},setValue:function(a){this.value=a;return this},isValid:function(){return this.regexp.test(this.getValue())}};
var s=f.Checkbox=function(a){var b="flagrate-checkbox-"+(++s.idCounter).toString(10);a=a||{};this.onChange=a.onChange||null;this.onCheck=a.onCheck||null;this.onUncheck=a.onUncheck||null;var c=a.attribute||{};c.id=a.id||null;c["class"]=a.className||null;var d=(new e("label",c)).updateText(a.label);d.writeAttribute("for",b);m(d,this);d.addClassName(f.className+" "+f.className+"-checkbox");a.icon&&(d.addClassName(f.className+"-icon"),d.setStyle({backgroundImage:"url("+a.icon+")"}));d._input=new e("input",
{id:b,type:"checkbox"});d.insert({top:new e});d.insert({top:d._input});d._input.addEventListener("change",function(a){if(d.isChecked()){if(d.onCheck)d.onCheck(a)}else if(d.onUncheck)d.onUncheck(a);if(d.onChange)d.onChange(a)});a.isChecked&&d.check();a.isDisabled&&d.disable();return d};s.idCounter=0;s.prototype={disable:function(){this.addClassName(f.className+"-checkbox-disabled");this._input.writeAttribute("disabled",!0);return this},enable:function(){this.removeClassName(f.className+"-checkbox-disabled");
this._input.writeAttribute("disabled",!1);return this},isEnabled:function(){return!this.hasClassName(f.className+"-checkbox-disabled")},isChecked:function(){return!!this._input.checked},check:function(){this._input.checked=!0;return this},uncheck:function(){this._input.checked=!1;return this}};var u=f.Radio=function(a){var b="flagrate-radio-"+(++u.idCounter).toString(10);a=a||{};var c=a.attribute||{};c.id=a.id||null;c["class"]=a.className||null;c=(new e("label",c)).updateText(a.label);c.writeAttribute("for",
b);m(c,this);c.addClassName(f.className+" "+f.className+"-radio");a.icon&&(c.addClassName(f.className+"-icon"),c.setStyle({backgroundImage:"url("+a.icon+")"}));c._input=new e("input",{id:b,type:"radio",name:a.name});c.insert({top:new e});c.insert({top:c._input});a.isChecked&&c.check();a.isDisabled&&c.disable();return c};u.idCounter=0;u.prototype={disable:function(){this.addClassName(f.className+"-radio-disabled");this._input.writeAttribute("disabled",!0);return this},enable:function(){this.removeClassName(f.className+
"-radio-disabled");this._input.writeAttribute("disabled",!1);return this},isEnabled:function(){return!this.hasClassName(f.className+"-radio-disabled")},isChecked:function(){return"checked"===this._input.readAttribute("checked")},check:function(){return this._input.writeAttribute("checked",!0)},uncheck:function(){return this._input.writeAttribute("checked",!1)}};var z=f.Progress=function(a){a=a||{};this.value=a.value||0;this.max=a.max||100;var b=a.attribute||{};b.id=a.id||null;b["class"]=a.className||
null;a=new e("div",b);m(a,this);a.addClassName(f.className+" "+f.className+"-progress");a._updateProgress();return a};z.prototype={getValue:function(){return this.value},setValue:function(a){if("number"!==typeof a)return this;this.value=Math.max(0,Math.min(this.max,a));return this._updateProgress()},_updateProgress:function(){var a=Math.max(0,Math.min(100,100*(this.value/this.max)));this.update((new e).setStyle({width:a+"%"}));return this}};(f.Slider=function(a){a=a||{};var b=new z(a);m(b,this);b.addClassName(f.className+
"-slider");b.addEventListener("mousedown",b._onPointerDownHandler.bind(b));b.addEventListener("touchstart",b._onPointerDownHandler.bind(b));b.addEventListener("MSPointerDown",b._onPointerDownHandler.bind(b));a.isDisabled&&b.disable();return b}).prototype={disable:function(){return this.addClassName(f.className+"-slider-disabled")},enable:function(){return this.removeClassName(f.className+"-slider-disabled")},isEnabled:function(){return!this.hasClassName(f.className+"-slider-disabled")},_onPointerDownHandler:function(a){if(this.isEnabled()){a.preventDefault();
var b=0,c=0;switch(a.type){case "mousedown":case "MSPointerDown":b=a.offsetX||a.layerX;c=a.clientX;break;case "touchstart":b=a.touches[0].clientX-a.target.offsetLeft,c=a.touches[0].clientX}this._slide(b,c)}},_slide:function(a,b){var c=this.getWidth()/this.max,d=function(d){d.preventDefault();d.touches&&d.touches[0]?(a=a+d.touches[0].clientX-b,b=d.touches[0].clientX):(a=a+d.clientX-b,b=d.clientX);this.setValue(Math.round(a/c))}.bind(this),e=function(f){f.preventDefault();document.body.removeEventListener("mousemove",
d);document.body.removeEventListener("touchmove",d);document.body.removeEventListener("MSPointerMove",d);document.body.removeEventListener("mouseup",e);document.body.removeEventListener("touchend",e);document.body.removeEventListener("touchcancel",e);document.body.removeEventListener("MSPointerUp",e);f.touches&&f.touches[0]&&(a=a+f.touches[0].clientX-b,this.setValue(Math.round(a/c)));f.clientX&&(a=a+f.clientX-b,this.setValue(Math.round(a/c)))}.bind(this);document.body.addEventListener("mousemove",
d);document.body.addEventListener("touchmove",d);document.body.addEventListener("MSPointerMove",d);document.body.addEventListener("mouseup",e);document.body.addEventListener("touchend",e);document.body.addEventListener("touchcancel",e);document.body.addEventListener("MSPointerUp",e);this.setValue(Math.round(a/c))}};(f.Notify=function(a){a=a||{};this.target=a.target||document.body;this.className=a.className||null;this.disableDesktopNotify=a.disableDesktopNotify||!1;this.hAlign=a.hAlign||"right";this.vAlign=
a.vAlign||"bottom";this.hMargin=a.hMargin||10;this.vMargin=a.vMargin||10;this.spacing=a.spacing||10;this.timeout=a.timeout||5;this.title=a.title||"Notify";this.notifies=[];!1===this.disableDesktopNotify&&(this.desktopNotifyType=null,"undefined"!==typeof window.webkitNotifications&&(this.desktopNotifyType="webkit"),null===this.desktopNotifyType&&(this.disableDesktopNotify=!0),"webkit"===this.desktopNotifyType&&1===window.webkitNotifications.checkPermission()&&this.create({text:"Click here to activate desktop notifications...",
onClick:function(){window.webkitNotifications.requestPermission()}.bind(this)}));return this}).prototype={create:function(a){a=a||{};if(!1===this.disableDesktopNotify&&!0===this.createDesktopNotify(a))return this;var b=a.title||this.title,c=a.message||a.body||a.content||a.text||null,d=a.onClick||null,k=a.onClose||null,g="undefined"!==typeof a.timeout?a.timeout:this.timeout,h=!0,n;a=this.hMargin;var m=this.vMargin,l=new e("div",{"class":this.className});l.addClassName(f.className+" "+f.className+"-notify");
(new e("div",{"class":"title"})).insertText(b).insertTo(l);(new e("div",{"class":"text"})).insertText(c).insertTo(l);(new e("div",{"class":"close"})).update("&#xd7;").insertTo(l).addEventListener("click",function(a){a.stopPropagation();a.preventDefault();h&&r()},!1);l.style.display="none";l.style.position="fixed";l.style[this.hAlign]=a+"px";l.style[this.vAlign]=m+"px";null===d?l.addEventListener("click",function(a){r()}):(l.style.cursor="pointer",l.addEventListener("click",function(a){a.stopPropagation();
a.preventDefault();d();r()}));this.target.appendChild(l);l.style.display="block";setTimeout(function(){l.style.opacity=1},10);if(0!==g){var p=function(){h&&r()};n=setTimeout(p,1E3*g);l.addEventListener("mouseover",function(){clearTimeout(n);n=setTimeout(p,1E3*g)})}var r=function(){h=!1;l.style.opacity=0;null!==k&&k();setTimeout(function(){this.target.removeChild(l);this.notifies.splice(this.notifies.indexOf(l),1);this.positioner()}.bind(this),300)}.bind(this);this.notifies.push(l);this.positioner();
return this},createDesktopNotify:function(a){var b=a.title||this.title,c=a.message||a.body||a.content||a.text||null,d=a.onClick||null,e=a.onClose||null;a="undefined"!==typeof a.timeout?a.timeout:this.timeout;var f=!0,h=null;if("webkit"===this.desktopNotifyType){if(0!==window.webkitNotifications.checkPermission())return!1;h=window.webkitNotifications.createNotification("",b,c)}0!==a&&setTimeout(function(){f&&h.cancel()},1E3*a);null===d?h.addEventListener("click",function(a){h.cancel()}):h.addEventListener("click",
function(a){d();h.cancel()});h.onclose=function(){f=!1;null!==e&&e()};h.show();return!0},positioner:function(){for(var a=this.target===document.body?window.innerHeight||document.body.clientHeight:this.target.offsetHeight,b=0,c=0,d=0,e=this.notifies.length;d<e;d++){var f=this.notifies[d],h=this.hMargin+c;f.style[this.hAlign]=(this.vMargin+b).toString(10)+"px";f.style[this.vAlign]=h.toString(10)+"px";c+=this.spacing+f.offsetHeight;c+f.offsetHeight+this.vMargin+this.spacing>=a&&(c=0,b+=this.spacing+
f.offsetWidth)}}};(f.Modal=function(a){a=a||{};this.target=a.target||document.body;this.id=a.id||null;this.className=a.className||null;this.title=a.title||"";this.subtitle=a.subtitle||"";this.text=a.text||"";this.html=a.html||"";this.element=a.element||null;this.href=a.href||"";this.buttons=a.buttons||[];this.sizing=a.sizing||"flex";this.onBeforeClose=a.onBeforeClose||function(){};this.onClose=a.onClose||function(){};this.onShow=a.onShow||function(){};this.disableCloseButton=a.disableCloseButton||
!1;this.disableCloseByMask=a.disableCloseByMask||!1;this.disableCloseByEsc=a.disableCloseByEsc||!1;0===this.buttons.length&&(this.buttons=[{label:"OK",color:"@blue",onSelect:this.close.bind(this),isFocused:!0}]);this._modal=new e("div");this._modal.addEventListener("click",function(a){a.stopPropagation()});!1===this.disableCloseButton&&(this._closeButton=(new p({label:"",onSelect:this.close.bind(this)})).insertTo(this._modal));this._header=(new e("hgroup")).insertTo(this._modal);(new e("h1")).insertText(this.title).insertTo(this._header);
(new e("small")).insertText(this.subtitle).insertTo(this._header);this._content=(new e("div")).insertTo(this._modal);this.content=(new e("div")).insertTo(this._content);""!==this.text&&this.content.insertText(this.text);""!==this.html&&this.content.update(this.html);null!==this.element&&this.content.update(this.element);this._footer=(new e("footer")).insertTo(this._modal);a=0;for(var b=this.buttons.length;a<b;a++){var c=this.buttons[a];c.button=new p({label:c.label,icon:c.icon,color:c.color,isFocuesed:c.isFocused||
!1,isDisabled:c.isDisabled,onSelect:this._createButtonOnSelectHandler(this,c)});this._footer.insert(c.button)}this._base=new e("div",{id:this.id,"class":this.className});this.target!==document.body&&(this._base.style.position="absolute");this._base.addClassName(f.className+" "+f.className+"-modal");this._obi=(new e("div")).update(this._modal).insertTo(this._base);!1===this.disableCloseByMask&&this._base.addEventListener("click",this.close.bind(this));this._onKeydownHandler=function(a){if("BODY"===
document.activeElement.tagName){a.stopPropagation();a.preventDefault();if(9===a.keyCode){if(this._closeButton)return this._closeButton.focus();if(this.buttons[0])return this.buttons[0].focus()}if(13===a.keyCode&&this.buttons[0])return this.buttons[0].button.click();if(27===a.keyCode)return this.close()}}.bind(this);return this}).prototype={visible:function(){return this._base.hasClassName(f.className+"-modal-visible")},show:function(){if(!0===this.visible())return this;this.closingTimer&&clearTimeout(this.closingTimer);
e.insert(this.target,this._base);setTimeout(function(){this._base.addClassName(f.className+"-modal-visible")}.bind(this),0);this.onShow(this);var a=-1,b=-1,c=-1,d=-1,k=function(){if(a!==this._base.getWidth()||b!==this._base.getHeight()||c!==this._modal.getWidth()||d!==this._modal.getHeight())a=this._base.getWidth(),b=this._base.getHeight(),c=this._modal.getWidth(),d=this._modal.getHeight(),"flex"===this.sizing&&(a-20<=c?(this._modal.style.left="10px",this._content.style.width=a-20+"px",this._content.style.overflowX=
"auto"):(this._modal.style.left=a/2-c/2+"px",this._content.style.width="",this._content.style.overflowX="visible"),b-20<=d?(this._obi.style.top="10px",this._obi.style.bottom="10px",this._obi.style.height="",this._content.style.height=b-this._header.getHeight()-this._footer.getHeight()-20+"px",this._content.style.overflowY="auto"):(this._obi.style.top=b/2-d/2+"px",this._obi.style.bottom="",this._obi.style.height=d+"px",this._content.style.height="",this._content.style.overflowY="visible")),"full"===
this.sizing&&(this._modal.style.right="10px",this._modal.style.left="10px",this._content.style.overflowX="auto",this._obi.style.top="10px",this._obi.style.bottom="10px",this._obi.style.height="",this._content.style.height=b-this._header.getHeight()-this._footer.getHeight()-20+"px",this._content.style.overflowY="auto");this.positioningTimer=setTimeout(k.bind(this),30)};this.positioningTimer=setTimeout(k.bind(this),0);!1===this.disableCloseByEsc&&window.addEventListener("keydown",this._onKeydownHandler);
return this},close:function(a){if(!1===this.visible())return this;this._base.removeClassName(f.className+"-modal-visible");a&&(a.stopPropagation(),a.preventDefault());if(!1===this.onBeforeClose(this,a))return this;clearTimeout(this.positioningTimer);this.closingTimer=setTimeout(function(){this._base.remove()}.bind(this),200);!1===this.disableCloseByEsc&&window.removeEventListener("keydown",this._onKeydownHandler);this.onClose(this,a);return this},_createButtonOnSelectHandler:function(a,b){return function(c){try{b.onSelect(c,
a)}catch(d){throw Error("flagrate.Modal: "+d);}}}};var v=f.Grid=function(a){a=a||{};this.id=a.id||null;this.className=a.className||null;this.attribute=a.attribute||null;this.style=a.style||null;this.cols=a.cols||[];this.rows=a.rows||[];this.pagination=a.pagination||!1;this.fill=a.fill||!1;this.headless=a.headless||!1;this.multiSelect=a.multiSelect||!1;this.disableCheckbox=a.disableCheckbox||!1;this.disableSelect=a.disableSelect||!1;this.disableSort=a.disableSort||!1;this.disableFilter=a.disableFilter||
!1;this.disableResize=a.disableResize||!1;this.onSelect=a.onSelect||null;this.onDeselect=a.onDeselect||null;this.onClick=a.onClick||null;this.onDblClick=a.onDblClick||null;this.onRender=a.onRender||null;this.onRendered=a.onRendered||null;this.postProcessingOfRow=a.postProcessingOfRow||null;this._id="flagrate-grid-"+(++v.idCounter).toString(10);this._selectedRows=[];this.pagination&&(this.numberOfRowsPerPage=a.numberOfRowsPerPage||20,this.pagePosition=0);return this._create()._requestRender()};v.idCounter=
0;v.prototype={insertTo:function(a){return this.element.insertTo(a)&&this},select:function(a){var b;if(a instanceof Array)b=a;else{b=[];for(var c=0,d=arguments.length;c<d;c++)"number"===typeof arguments[c]?this.rows[arguments[c]]&&b.push(this.rows[arguments[c]]):"object"===typeof a&&b.push(a)}!1===this.multiSelect&&this.deselectAll();c=0;for(d=b.length;c<d;c++){var e=b[c];e.isSelected=!0;if(!e._tr||!0!==e._tr.hasClassName(f.className+"-grid-row-selected")){this._selectedRows.push(e);e._tr&&e._tr.addClassName(f.className+
"-grid-row-selected");e._checkbox&&e._checkbox.check();if(e.onSelect)e.onSelect(window.event,e);if(this.onSelect)this.onSelect(window.event,e)}}0!==this._selectedRows.length&&this._checkbox&&this._checkbox.check();return this},deselect:function(a){var b;if(a instanceof Array)b=a;else{b=[];for(var c=0,d=arguments.length;c<d;c++)"number"===typeof arguments[c]?this.rows[arguments[c]]&&b.push(this.rows[arguments[c]]):"object"===typeof a&&b.push(a)}c=0;for(d=b.length;c<d;c++){var e=b[c];e.isSelected=!1;
if(!e._tr||!1!==e._tr.hasClassName(f.className+"-grid-row-selected")){this._selectedRows.splice(this._selectedRows.indexOf(e),1);e._tr&&e._tr.removeClassName(f.className+"-grid-row-selected");e._checkbox&&e._checkbox.uncheck();if(e.onDeselect)e.onDeselect(window.event,e);if(this.onDeselect)this.onDeselect(window.event,e)}}0===this._selectedRows.length&&this._checkbox&&this._checkbox.uncheck();return this},selectAll:function(){return this.select(this.rows)},deselectAll:function(){return this.deselect(this.rows)},
getSelectedRows:function(){return this._selectedRows},sort:function(a,b){this.rows.sort(function(b,c){var d=0,e=0;b.cell[a]&&(d=b.cell[a].sortAlt||b.cell[a].text||b.cell[a].html||b.cell[a].element&&b.cell[a].element.innerHTML||b.cell[a]._div&&b.cell[a]._div.innerHTML||0);c.cell[a]&&(e=c.cell[a].sortAlt||c.cell[a].text||c.cell[a].html||c.cell[a].element&&c.cell[a].element.innerHTML||c.cell[a]._div&&c.cell[a]._div.innerHTML||0);return d>e?1:-1});b||this.rows.reverse();for(var c=0,d=this.cols.length;c<
d;c++)this.cols[c].key===a?(this.cols[c]._th&&(b?(this.cols[c]._th.addClassName(f.className+"-grid-col-sorted-asc"),this.cols[c]._th.removeClassName(f.className+"-grid-col-sorted-desc")):(this.cols[c]._th.addClassName(f.className+"-grid-col-sorted-desc"),this.cols[c]._th.removeClassName(f.className+"-grid-col-sorted-asc"))),this.cols[c].isSorted=!0,this.cols[c].isAsc=!!b):(this.cols[c].isSorted&&this.cols[c]._th&&this.cols[c]._th.removeClassName(f.className+"-grid-col-sorted-asc").removeClassName(f.className+
"-grid-col-sorted-desc"),this.cols[c].isSorted=!1,this.cols[c].isAsc=null);this._requestRender();return this},unshift:function(a){if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this.rows.unshift(a);else this.rows.unshift(a);this._requestRender();return this.rows.length},push:function(a){if(a instanceof Array)for(var b=0,c=a.length;b<c;b++)this.rows.push(a);else this.rows.push(a);this._requestRender();return this.rows.length},shift:function(a){a=a||1;for(var b=[],c=0,d=this.rows.length;c<d&&
c<a;c++)b.push(this.rows.shift());this._requestRender();return 1===a?b[0]:b},pop:function(a){a=a||1;for(var b=[],c=0,d=this.rows.length;c<d&&c<a;c++)b.push(this.rows.pop());this._requestRender();return 1===a?b[0]:b},splice:function(a,b,c){b=b||this.rows.length-a;b=this.rows.splice(a,b);!1===c instanceof Array&&(c=[c]);for(var d=0,e=c.length;d<e;d++)this.rows.splice(a+d,0,c[d]);this._requestRender();return b},indexOf:function(a,b){return this.rows.indexOf(a,b)},"delete":function(a){var b=[];!1===a instanceof
Array&&(a=[a]);for(var c=0,d=a.length;c<d;c++){var e=this.indexOf(a[c]);-1!==e&&b.push(this.splice(e,1))}return b},_create:function(){this.element=new e("div");this.id&&this.element.writeAttribute("id",this.id);this.className&&this.element.writeAttribute("class",this.className);this.attribute&&this.element.writeAttribute(this.attribute);this.style&&this.element.setStyle(this.style);this.element.addClassName(f.className+" "+f.className+"-grid");this.headless&&this.element.addClassName(f.className+
"-grid-headless");this._head=(new e("div",{"class":f.className+"-grid-head"})).insertTo(this.element);this._thead=(new e("thead")).insertTo((new e("table")).insertTo(this._head));this._body=(new e("div",{"class":f.className+"-grid-body"})).insertTo(this.element);this._tbody=(new e("tbody")).insertTo((new e("table")).insertTo(this._body));this._style=(new e("style")).insertTo(this.element);this._style.type="text/css";var a=(new e("tr")).insertTo(this._thead);!1===this.disableCheckbox&&(!1===this.disableSelect&&
!0===this.multiSelect)&&(this._checkbox=(new s({onCheck:this.selectAll.bind(this),onUncheck:this.deselectAll.bind(this)})).insertTo((new e("th",{"class":f.className+"-grid-cell-checkbox"})).insertTo(a)));for(var b=0,c=this.cols.length;b<c;b++){var d=this.cols[b];d._id=this._id+"-col-"+b.toString(10);d._th=(new e("th")).insertTo(a);d.id&&d._th.writeAttribute("id",d.id);d.className&&d._th.writeAttribute("class",d.className);d.attribute&&d._th.writeAttribute(d.attribute);d.style&&d._th.setStyle(d.style);
d._th.addClassName(d._id);var k=d.width?d.width.toString(10)+"px":"auto";this._style.insertText("."+d._id+"{width:"+k+"}");d.align&&(d._th.style.textAlign=d.align);d._div=(new e).insertTo(d._th);d.label&&d._div.updateText(d.label);d.icon&&(d._div.addClassName(f.className+"-icon"),d._div.setStyle({backgroundImage:"url("+d.icon+")"}));!1!==this.disableResize||d.disableResize||(d._resizeHandle=(new e("div",{"class":f.className+"-grid-col-resize-handle"})).insertTo(this.element),d._resizeHandle.onmousedown=
this._createResizeHandleOnMousedownHandler(this,d));!1!==this.disableSort||d.disableSort||(d._th.addClassName(f.className+"-grid-col-sortable"),d._th.onclick=this._createColOnClickHandler(this,d))}(new e("th",{"class":this._id+"-col-last"})).insertTo(a);this._style.insertText("."+this._id+"-col-last:after{right:0}");this.pagination&&(this.element.addClassName(f.className+"-grid-pagination"),this._pager=(new x({className:f.className+"-grid-pager",items:[{key:"rn",element:(new e("span")).insertText("-")},
{key:"first",element:new p({className:f.className+"-grid-pager-first",onSelect:function(){this.pagePosition=0;this._requestRender()}.bind(this)})},{key:"prev",element:new p({className:f.className+"-grid-pager-prev",onSelect:function(){--this.pagePosition;this._requestRender()}.bind(this)})},{key:"num",element:(new e("span",{"class":f.className+"-grid-pager-num"})).insertText("-")},{key:"next",element:new p({className:f.className+"-grid-pager-next",onSelect:function(){++this.pagePosition;this._requestRender()}.bind(this)})},
{key:"last",element:new p({className:f.className+"-grid-pager-last",onSelect:function(){this.pagePosition=Math.floor(this.rows.length/this.numberOfRowsPerPage);this._requestRender()}.bind(this)})}]})).insertTo(this.element));this.fill?(this.element.addClassName(f.className+"-grid-fill"),this._body.onscroll=this._createBodyOnScrollHandler(this)):this.element.onscroll=this._createOnScrollHandler(this);return this},_requestRender:function(){this._renderTimer&&clearTimeout(this._renderTimer);this._renderTimer=
setTimeout(this._render.bind(this),0);return this},_render:function(){if(null!==this.onRender&&!1===this.onRender(this))return this;var a=!1===this.disableCheckbox&&!1===this.disableSelect&&!0===this.multiSelect,b,c,d,k,g,h,n,m,l,p=this.rows.length,r=this.cols.length;this.pagination&&(h=0,n=Math.ceil(p/this.numberOfRowsPerPage),n<=this.pagePosition&&(this.pagePosition=n-1),0>=this.pagePosition&&(this.pagePosition=0),m=this.pagePosition*this.numberOfRowsPerPage,l=m+this.numberOfRowsPerPage);this._tbody.update();
for(b=0;b<p;b++){if(this.pagination){if(b<m)continue;if(b>=l)break;++h}d=this.rows[b];d._tr||(d._tr=new e("tr"));d._tr.insertTo(this._tbody);d.id&&d._tr.writeAttribute("id",d.id);d.className&&d._tr.writeAttribute("class",d.className);d.attribute&&d._tr.writeAttribute(d.attribute);d.style&&d._tr.setStyle(d.style);if(d.onClick||this.onClick||!1===this.disableSelect)!1===this.disableSelect&&d._tr.addClassName(f.className+"-grid-row-selectable"),(d.onClick||this.onClick)&&d._tr.addClassName(f.className+
"-grid-row-clickable"),d._tr.onclick=this._createRowOnClickHandler(this,d);if(d.onDblClick||this.onDblClick)d._tr.ondblclick=this._createRowOnDblClickHandler(this,d);a&&!d._checkbox&&(d._checkbox=(new s({onChange:this._createRowOnCheckHandler(this,d)})).insertTo((new e("td",{"class":f.className+"-grid-cell-checkbox"})).insertTo(d._tr)));!0===d.isSelected&&this.select(d);for(c=0;c<r;c++)k=this.cols[c],g=d.cell[k.key]||(d.cell[k.key]={}),g._td||(g._td=new e("td")),g._td.insertTo(d._tr),g.id&&g._td.writeAttribute("id",
g.id),g.className&&g._td.writeAttribute("class",g.className),g.attribute&&g._td.writeAttribute(g.attribute),g.style&&g._td.setStyle(g.style),k.align&&(g._td.style.textAlign=k.align),g._td.addClassName(k._id),g._div||(g._div=new e),g._div.insertTo(g._td),g.text&&g._div.updateText(g.text),g.html&&g._div.update(g.html),g.element&&g._div.update(g.element),g.icon&&(g._div.addClassName(f.className+"-icon"),g._div.setStyle({backgroundImage:"url("+g.icon+")"})),g.onClick&&(g._td.addClassName(f.className+
"-grid-cell-clickable"),g._td.onclick=this._createCellOnClickHandler(this,g)),g.onDblClick&&(g._td.ondblclick=this._createCellOnDblClickHandler(this,g)),g.postProcess&&g.postProcess(g._td);d._last||(d._last=new e("td",{"class":this._id+"-col-last"}));d._last.insertTo(d._tr);d.menuItems&&(d._last.addClassName(f.className+"-grid-cell-menu"),d._menu&&d._menu.remove(),d._menu=new w({target:d._tr,items:d.menuItems}),d._last.onclick=this._createLastRowOnClickHandler(this,d));d.postProcess&&d.postProcess(d._tr);
this.postProcessOfRow&&this.postProcessOfRow(d._tr)}this.pagination&&(this._pager.getElementByKey("rn").updateText(m+1+" - "+(m+h)+" / "+p),this._pager.getElementByKey("num").updateText(this.pagePosition+1+" / "+n));!1===this.disableResize&&(this.fill&&(this._head.style.right=this._body.offsetWidth-this._body.clientWidth+"px",this._head.scrollLeft=this._body.scrollLeft),this._updateLayoutOfCols(),this._updatePositionOfResizeHandles());if(null!==this.onRendered)this.onRendered(this);return this},_updatePositionOfResizeHandles:function(){for(var a=
this.fill?-this._body.scrollLeft:0,b,c=0,d=this.cols.length;c<d;c++)b=this.cols[c],b._resizeHandle&&(b._resizeHandle.style.left=b._th.offsetLeft+b._th.getWidth()+a+"px");return this},_updateLayoutOfCols:function(){for(var a,b=0,c=this.cols.length;b<c;b++)a=this.cols[b],a.width||(a.width=a._th.getWidth(),this._style.updateText(this._style.innerHTML.replace(RegExp("("+a._id+"{width:)([^}]*)}"),"$1"+a.width+"px}")));this.element.addClassName(f.className+"-grid-fixed");setTimeout(function(){var a=this.fill?
this._body:this.element;this._style.updateText(this._style.innerHTML.replace(RegExp("("+this._id+"-col-last:after{right:)([^}]*)}"),"$1"+(a.scrollWidth-a.clientWidth-a.scrollLeft)+"px!important}"))}.bind(this),0);return this},_createOnScrollHandler:function(a){return function(b){!1===a.disableResize&&a._updateLayoutOfCols()}},_createBodyOnScrollHandler:function(a){return function(b){a._head.style.right=a._body.offsetWidth-a._body.clientWidth+"px";a._head.scrollLeft=a._body.scrollLeft;!1===a.disableResize&&
(a._updateLayoutOfCols(),a._updatePositionOfResizeHandles())}},_createColOnClickHandler:function(a,b){return function(c){a.sort(b.key,!b.isAsc)}},_createRowOnClickHandler:function(a,b){return function(c){if(b.onClick)b.onClick(c,b);if(a.onClick)a.onClick(c,b);!1===a.disableSelect&&(!0===b.isSelected?a.deselect(b):a.select(b))}},_createRowOnDblClickHandler:function(a,b){return function(c){if(b.onDblClick)b.onDblClick(c,b);if(a.onDblClick)a.onDblClick(c,b)}},_createCellOnClickHandler:function(a,b){return function(a){if(b.onClick)b.onClick(a,
b)}},_createCellOnDblClickHandler:function(a,b){return function(a){if(b.onDblClick)b.onDblClick(a,b)}},_createRowOnCheckHandler:function(a,b){return function(c){c.stopPropagation();!1===a.disableSelect&&(!0===b.isSelected?a.deselect(b):a.select(b))}},_createLastRowOnClickHandler:function(a,b){return function(a){a.stopPropagation();b._menu&&b._menu.open()}},_createResizeHandleOnMousedownHandler:function(a,b){return function(c){c.preventDefault();var d=c.clientX,e=d,f=function(a){a.preventDefault();
a=a.clientX-d;d+=a;b._resizeHandle.style.left=parseInt(b._resizeHandle.style.left.replace("px",""),10)+a+"px"},h=function(c){c.preventDefault();document.body.removeEventListener("mousemove",f,!0);document.body.removeEventListener("mouseup",h,!0);c=c.clientX-e;c=b._th.getWidth()+c;c=b.width=0>c?0:c;a._style.updateText(a._style.innerHTML.replace(RegExp("("+b._id+"{width:)([^}]*)}"),"$1"+c+"px}"));a._updateLayoutOfCols();a._updatePositionOfResizeHandles()};document.body.addEventListener("mousemove",
f,!0);document.body.addEventListener("mouseup",h,!0)}}}})();
